
-- –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –¥–ª—è –∫–Ω–∏–≥
CREATE TABLE public.books (
  id UUID NOT NULL DEFAULT gen_random_uuid() PRIMARY KEY,
  title TEXT NOT NULL,
  author TEXT NOT NULL,
  genre TEXT NOT NULL,
  rating DECIMAL(2,1) CHECK (rating >= 0 AND rating <= 5),
  description TEXT,
  pages INTEGER CHECK (pages > 0),
  year INTEGER CHECK (year > 0),
  image TEXT,
  read_by_colleagues INTEGER DEFAULT 0,
  created_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now(),
  updated_at TIMESTAMP WITH TIME ZONE NOT NULL DEFAULT now()
);

-- –í–∫–ª—é—á–∞–µ–º Row Level Security –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã –∫–Ω–∏–≥
ALTER TABLE public.books ENABLE ROW LEVEL SECURITY;

-- –°–æ–∑–¥–∞–µ–º –ø–æ–ª–∏—Ç–∏–∫—É, –ø–æ–∑–≤–æ–ª—è—é—â—É—é –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –∫–Ω–∏–≥–∏
CREATE POLICY "Anyone can view books" 
  ON public.books 
  FOR SELECT 
  USING (true);

-- –°–æ–∑–¥–∞–µ–º –ø–æ–ª–∏—Ç–∏–∫—É, –ø–æ–∑–≤–æ–ª—è—é—â—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –¥–æ–±–∞–≤–ª—è—Ç—å –∫–Ω–∏–≥–∏
CREATE POLICY "Authenticated users can insert books" 
  ON public.books 
  FOR INSERT 
  TO authenticated
  WITH CHECK (true);

-- –°–æ–∑–¥–∞–µ–º –ø–æ–ª–∏—Ç–∏–∫—É, –ø–æ–∑–≤–æ–ª—è—é—â—É—é –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–Ω–∏–≥–∏
CREATE POLICY "Authenticated users can update books" 
  ON public.books 
  FOR UPDATE 
  TO authenticated
  USING (true);

-- –í—Å—Ç–∞–≤–ª—è–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
INSERT INTO public.books (title, author, genre, rating, description, pages, year, image, read_by_colleagues) VALUES
('–ß–∏—Å—Ç—ã–π –∫–æ–¥', '–†–æ–±–µ—Ä—Ç –ú–∞—Ä—Ç–∏–Ω', '–ü—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ', 4.8, '–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞–ø–∏—Å–∞–Ω–∏—é –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –∫–æ–¥–∞', 464, 2008, 'üìö', 45),
('–ê—Ä—Ö–∏—Ç–µ–∫—Ç–æ—Ä –ü–û –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ', '–õ–µ–Ω –ë–∞—Å—Å', '–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ü–û', 4.6, '–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è', 512, 2012, 'üèóÔ∏è', 23),
('–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è –≤–ª–∏—è–Ω–∏—è', '–†–æ–±–µ—Ä—Ç –ß–∞–ª–¥–∏–Ω–∏', '–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è', 4.9, '–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –∫–Ω–∏–≥–∞ –æ –ø—Ä–∏–Ω—Ü–∏–ø–∞—Ö –≤–ª–∏—è–Ω–∏—è –∏ —É–±–µ–∂–¥–µ–Ω–∏—è', 336, 2006, 'üß†', 67),
('Lean Startup', '–≠—Ä–∏–∫ –†–∏—Å', '–ë–∏–∑–Ω–µ—Å', 4.7, '–ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è —Å–æ–∑–¥–∞–Ω–∏—è —É—Å–ø–µ—à–Ω—ã—Ö —Å—Ç–∞—Ä—Ç–∞–ø–æ–≤', 336, 2011, 'üöÄ', 34),
('–î–∏–∑–∞–π–Ω –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã—Ö –≤–µ—â–µ–π', '–î–æ–Ω –ù–æ—Ä–º–∞–Ω', '–î–∏–∑–∞–π–Ω', 4.5, '–û—Å–Ω–æ–≤—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –æ–ø—ã—Ç–∞ –∏ –¥–∏–∑–∞–π–Ω–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤', 368, 2013, 'üé®', 28),
('–°–Ω–∞—á–∞–ª–∞ —Å–∫–∞–∂–∏—Ç–µ –ù–ï–¢', '–î–∂–∏–º –ö—ç–º–ø', '–ü–µ—Ä–µ–≥–æ–≤–æ—Ä—ã', 4.4, '–°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤, –æ—Å–Ω–æ–≤–∞–Ω–Ω–∞—è –Ω–∞ —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç–µ', 352, 2002, 'üíº', 19);
